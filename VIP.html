<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NoBook è´¦æˆ·æŸ¥è¯¢</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "å¾®è½¯é›…é»‘", "PingFang SC", sans-serif; }
    body { min-height: 100vh; background: #f5f7fa; display: flex; justify-content: center; align-items: center; padding: 20px; }
    .container { width: 100%; max-width: 550px; background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); padding: 35px 25px; }
    .nb-logo-wrapper {
      width: 120px;
      height: 120px;
      margin: 0 auto 20px;
      border-radius: 50%; 
      overflow: hidden; 
      border: 1px solid #eee; 
    }
    .nb-logo {
      width: 100%;
      height: 100%;
      object-fit: cover; 
      display: block;
    }
    h1 { text-align: center; color: #2c3e50; font-size: 22px; margin-bottom: 10px; font-weight: 600; }
    .time-tips { 
      text-align: center; 
      font-size: 14px; 
      margin-bottom: 20px; 
      line-height: 1.6;
    }
    .create-time { color: #666; }
    .expire-time { color: #ff4444; }
    .input-group { 
      visibility: hidden; 
      height: 0; 
      margin: 0; 
      padding: 0; 
      overflow: hidden;
    }
    #keyInput { flex: 1; height: 48px; padding: 0 15px; border: 1px solid #e1e5eb; border-radius: 8px; font-size: 16px; outline: none; transition: border 0.3s; }
    #keyInput:focus { border-color: #409eff; box-shadow: 0 0 0 2px rgba(64,158,255,0.1); }
    #submitBtn { height: 48px; padding: 0 20px; background: #409eff; color: #fff; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; transition: background 0.3s; }
    #submitBtn:hover { background: #337ecc; }
    #submitBtn:disabled { background: #b3d4fc; cursor: not-allowed; }
    #contentArea { min-height: 120px; padding: 18px; border-radius: 8px; background: #f8fafc; border: 1px solid #e1e5eb; white-space: pre-wrap; line-height: 1.5; color: #333; font-size: 15px; margin-bottom: 20px; text-align: left; }
    .error { color: #f56c6c; }
    .loading { color: #888; }
    .nb-tips {
      background: #fef0f0;
      border: 1px solid #fde2e2;
      border-radius: 8px;
      padding: 20px 15px;
      font-size: 15px;
      line-height: 1.5;
      color: #721c24;
      letter-spacing: 0.5px;
      text-align: center;
      word-wrap: break-word;
      word-break: break-all;
      width: 100%;
    }
    .nb-tips .emphasis { 
      color: #dc3345; 
      font-weight: 700; 
      font-size: 16px; 
      display: block; 
      margin: 8px 0;
      border-bottom: 1px dashed #e6e9ed; 
      padding-bottom: 8px; 
    }
    .nb-tips .url-group { 
      margin: 12px 0; 
      padding-left: 0; 
      text-align: left; 
      display: inline-block; 
      width: 100%;
      max-width: 400px;
    }
    .nb-tips .url-item { 
      display: block; 
      margin: 5px 0; 
      word-break: break-all;
      hyphens: auto;
      text-align: left; 
    }
    .nb-tips a {
      color: #0d6efd; 
      text-decoration: none;
      transition: color 0.2s;
      word-break: break-all;
    }
    .nb-tips a:hover {
      color: #0a58ca;
      text-decoration: underline;
    }
    .nb-tips > div {
      width: 100%;
      max-width: 450px;
      margin-left: auto;
      margin-right: auto;
    }
@keyframes jump {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
.jump-text {
  display: inline-block;
  margin-left: 5px;
}
.jump-text span {
  display: inline-block;
  animation: jump 0.8s infinite alternate ease-in-out;
  font-weight: 700;
  color: #dc3545;
}
.jump-text span:nth-child(1) { animation-delay: 0s; }
.jump-text span:nth-child(2) { animation-delay: 0.2s; }
.jump-text span:nth-child(3) { animation-delay: 0.4s; }
.jump-text span:nth-child(4) { animation-delay: 0.6s; }
  </style>
</head>
<body>
  <div class="container">
    <div class="nb-logo-wrapper">
      <img src="https://i.imgs.ovh/2026/02/08/ylgvLU.png" alt="NBå®éªŒå®¤LOGO" class="nb-logo">
    </div>
    <h1>NoBook è´¦æˆ·æŸ¥è¯¢</h1>
    <div class="time-tips" id="timeTips">
      <div class="create-time">åˆ›å»ºæ—¶é—´ï¼š</div>
      <div class="expire-time">è¯¥é¡µé¢å°†ä¼šåœ¨å°æ—¶åˆ†é’Ÿåè¢«é”€æ¯</div>
    </div>
    <div class="input-group">
      <input type="text" id="keyInput" placeholder="è¯·è¾“å…¥4ä½æå–å¯†é’¥">
      <button id="submitBtn" onclick="getMemo()">ç¡®è®¤æŸ¥çœ‹</button>
    </div>
    <div id="contentArea" class="loading">è¯·è¾“å…¥å¯†é’¥å¹¶ç‚¹å‡»æŸ¥çœ‹</div>
    
    <div class="nb-tips">
      <span class="emphasis" style="display: flex; align-items: center; justify-content: center; gap: 8px;">
        <div style="text-align: center;">
          <div>ğŸ’¬ é˜²å¤±è”ã€åŠ +å¾®ä¿¡ï¼šNB_Helperã€‘</div>
          <div style="font-size: 14px; font-weight: normal; color: #721c24; margin-top: 4px;">éœ€è¦å­¦ç”Ÿç«¯ App å¯å¾®ä¿¡å’¨è¯¢</div>
        </div>
        <img src="https://i.imgs.ovh/2026/02/08/ylpQTL.jpeg" style="width:50px; height:50px; border-radius:4px;">
      </span>
      <div class="url-group">
        <span class="url-item">ã€NBå®éªŒå®¤ NoBook æ•™å¸ˆç«¯ã€‘</span>
        <span class="url-item">âœ… æ”¯æŒ ç½‘é¡µç™»å½•!ç”µè„‘Appå®¢æˆ·ç«¯ï¼</span>
        <span class="url-item">âœ… æ”¯æŒ ç”µè„‘å¸Œæ²ƒç™½æ¿/Classin ç»‘å®šä½¿ç”¨ï¼</span>
        <span class="url-item">âŒ ä¸æ”¯æŒ æ‰‹æœº/å¹³æ¿ ç§»åŠ¨ç«¯Appï¼</span>
        <span class="url-item"> (æ‰‹æœº/å¹³æ¿/å­¦ä¹ æœº åªèƒ½ç½‘é¡µç™»å½•!)</span>
        <span class="url-item" style="margin-top: 10px;">ğŸ“– å›¾æ–‡ä½¿ç”¨æ•™ç¨‹: ç‚¹å‡» >
          <a href="https://nobook-vip.netlify.app/tips.html" target="_blank" class="jump-text">
            <span>T</span><span>i</span><span>p</span><span>s</span>
          </a>
        </span>
        <span class="url-item" style="margin-top: 10px;">ğŸŒ å®˜æ–¹å­¦ç§‘ç½‘å€:</span>
        <span class="url-item">NBç‰©ç†å®éªŒ:<a href="https://wl.nobook.com" target="_blank">https://wl.nobook.com</a></span>
        <span class="url-item">NBåŒ–å­¦å®éªŒ:<a href="https://hx.nobook.com" target="_blank">https://hx.nobook.com</a></span>
        <span class="url-item">NBåˆä¸­ç”Ÿç‰©:<a href="https://czsw.nobook.com" target="_blank">https://czsw.nobook.com</a></span>
        <span class="url-item">NBé«˜ä¸­ç”Ÿç‰©:<a href="https://gzsw.nobook.com" target="_blank">https://gzsw.nobook.com</a></span>
        <span class="url-item">NBå°å­¦ç§‘å­¦:<a href="https://science.nobook.com" target="_blank">https://science.nobook.com</a></span>
      </div>
      <span class="emphasis">äº²ï¼è¯·çœ‹å­—ï¼è¯·çœ‹å­—ï¼è¯·çœ‹å­—ï¼</span>
    </div>
  </div>
  <script>
    const keyInput = document.getElementById('keyInput');
    const submitBtn = document.getElementById('submitBtn');
    const contentArea = document.getElementById('contentArea');
    const timeTips = document.getElementById('timeTips');
    const JSONBIN_API = 'https://api.jsonbin.io/v3/b';
    const JSONBIN_KEY = '{{JSONBIN_KEY}}';
    let binId = '';

    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      const cParam = params.get('c') || '';
      if (cParam.includes('_')) {
        const [parseKey, parseBinId] = cParam.split('_');
        if (parseKey && parseKey.length === 4 && parseBinId) {
          keyInput.value = parseKey;
          binId = parseBinId;
          setTimeout(() => getMemo(), 100);
        }
      }
    });

    function calculateRemainingTime(expiredAt) {
      if (!expiredAt) return { hours: 0, minutes: 0 };
      const expireTime = new Date(expiredAt).getTime();
      const now = new Date().getTime();
      const diff = expireTime - now;
      if (diff <= 0) return { hours: 0, minutes: 0 };
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      return { hours, minutes };
    }

    function formatCreateTime(isoTime) {
      if (!isoTime) return 'æœªçŸ¥';
      const date = new Date(isoTime);
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      const hours = String(date.getHours()).padStart(2, '0');
      const minutes = String(date.getMinutes()).padStart(2, '0');
      const seconds = String(date.getSeconds()).padStart(2, '0');
      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }

    function updateTimeTips(createdAt, expiredAt) {
      const createTimeText = formatCreateTime(createdAt);
      const { hours, minutes } = calculateRemainingTime(expiredAt);
      timeTips.innerHTML = `
        <div class="create-time">åˆ›å»ºæ—¶é—´ï¼š${createTimeText}</div>
        <div class="expire-time">è¯¥é¡µé¢å°†ä¼šåœ¨${hours}å°æ—¶${minutes}åˆ†é’Ÿåè¢«é”€æ¯</div>
      `;
    }

    async function getMemo() {
      const inputKey = keyInput.value.trim();
      contentArea.className = '';

      if (!binId) {
        contentArea.className = 'error';
        contentArea.textContent = 'æœªè·å–åˆ°æœ‰æ•ˆæŸ¥è¯¢å‚æ•°ï¼Œè¯·æ£€æŸ¥é“¾æ¥æ˜¯å¦æ­£ç¡®ï¼';
        return;
      }

      if (inputKey.length !== 4) {
        contentArea.className = 'error';
        contentArea.textContent = 'è¯·è¾“å…¥4ä½æå–å¯†é’¥ï¼';
        return;
      }

      contentArea.className = 'loading';
      contentArea.textContent = 'æ­£åœ¨æŸ¥è¯¢è´¦æˆ·...';
      submitBtn.disabled = true;
      timeTips.innerHTML = `
        <div class="create-time">åˆ›å»ºæ—¶é—´ï¼šæŸ¥è¯¢ä¸­...</div>
        <div class="expire-time">è¯¥é¡µé¢å°†ä¼šåœ¨æŸ¥è¯¢ä¸­...å°æ—¶æŸ¥è¯¢ä¸­...åˆ†é’Ÿåè¢«é”€æ¯</div>
      `;

      try {
        const res = await fetch(`${JSONBIN_API}/${binId}/latest`, {
          headers: { 
            'X-Master-Key': JSONBIN_KEY, 
            'Content-Type': 'application/json'
          }
        });

        if (!res.ok) throw new Error(`è¯·æ±‚å¤±è´¥ï¼ˆçŠ¶æ€ç ï¼š${res.status}ï¼‰`);
        const data = await res.json();
        let memoContent = '';
        const memoData = data.record[inputKey];

        if (typeof memoData === 'object' && memoData.content) {
          memoContent = memoData.content;
          updateTimeTips(memoData.created_at, memoData.expired_at);
        } else if (typeof memoData === 'string') {
          memoContent = memoData;
          timeTips.innerHTML = `
            <div class="create-time">åˆ›å»ºæ—¶é—´ï¼šæœªçŸ¥</div>
            <div class="expire-time">è¯¥é¡µé¢å°†ä¼šåœ¨24å°æ—¶0åˆ†é’Ÿåè¢«é”€æ¯</div>
          `;
        } else {
          memoContent = 'è´¦æˆ·æ­£åœ¨è·å–ä¸­,è¯·ç¨åï¼2åˆ†é’Ÿåå†æ¬¡åˆ·æ–°æŸ¥çœ‹!';
          timeTips.innerHTML = `
            <div class="create-time">åˆ›å»ºæ—¶é—´ï¼š</div>
            <div class="expire-time">è¯¥é¡µé¢å°†ä¼šåœ¨å°æ—¶åˆ†é’Ÿåè¢«é”€æ¯</div>
          `;
        }
        contentArea.textContent = memoContent;
      } catch (err) {
        contentArea.className = 'error';
        contentArea.textContent = `è¯·æ±‚å¤±è´¥ï¼š${err.message}\nå¯è®¿é—®åŸç«™ï¼šhttps://n.showmsg.cn/view/${inputKey}`;
        timeTips.innerHTML = `
          <div class="create-time">åˆ›å»ºæ—¶é—´ï¼š</div>
          <div class="expire-time">è¯¥é¡µé¢å°†ä¼šåœ¨å°æ—¶åˆ†é’Ÿåè¢«é”€æ¯</div>
        `;
      } finally {
        submitBtn.disabled = false;
      }
    }
  </script>
</body>
</html>
